<Page x:Class="SplashGoJunpro.Views.MyDestinationsPage"
     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
     xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
     xmlns:local="clr-namespace:SplashGoJunpro.Converters"
     mc:Ignorable="d" 
     d:DesignHeight="800" d:DesignWidth="1200"
     Title="My Destinations">

    <Page.Resources>
        <local:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <local:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter"/>

        <!-- Add the missing TextGray resource -->
        <SolidColorBrush x:Key="TextGray" Color="#666666"/>

        <!-- Card Style -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- Stat Card Style -->
        <Style x:Key="StatCardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- Button Style -->
        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#2196F3"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                               CornerRadius="5"
                               Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1976D2"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Page.Resources>

    <Grid Background="White">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20">
                <!-- Header -->
                <StackPanel Margin="0,0,0,20">
                    <TextBlock Text="My Destinations" 
                              FontSize="28" 
                              FontWeight="Bold" 
                              Foreground="#333333"/>
                    <TextBlock Text="Manage and analyze your destinations" 
                              FontSize="14" 
                              Foreground="#666666" 
                              Margin="0,5,0,0"/>
                </StackPanel>

                <!-- Loading Indicator -->
                <StackPanel x:Name="LoadingPanel"
                           Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}"
                           HorizontalAlignment="Center" 
                           Margin="0,100,0,0">
                    <TextBlock Text="⏳" FontSize="48" HorizontalAlignment="Center"/>
                    <TextBlock Text="Loading destinations..." 
                              FontSize="16" 
                              Foreground="#666666" 
                              Margin="0,10,0,0"
                              HorizontalAlignment="Center"/>
                </StackPanel>

                <!-- Main Content -->
                <StackPanel x:Name="MainContent"
                           Visibility="{Binding IsLoading, Converter={StaticResource InverseBoolToVisibilityConverter}}">

                    <!-- Statistics and Charts Section -->
                    <Grid Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Left Column: Stats + Revenue Chart -->
                        <StackPanel Grid.Column="0" Margin="0,0,10,0">
                            <!-- Statistics Summary Cards -->
                            <Grid Margin="0,0,0,20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Total Destinations -->
                                <Border Grid.Column="0" Style="{StaticResource StatCardStyle}" Margin="0,0,10,0">
                                    <StackPanel>
                                        <TextBlock Text="📍" FontSize="24" Margin="0,0,0,5"/>
                                        <TextBlock Text="Total Destinations" 
                                                  FontSize="12" 
                                                  Foreground="#666666"/>
                                        <TextBlock Text="{Binding Analytics.TotalDestinations}" 
                                                  FontSize="28" 
                                                  FontWeight="Bold" 
                                                  Foreground="#2196F3" 
                                                  Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>

                                <!-- Total Bookings -->
                                <Border Grid.Column="1" Style="{StaticResource StatCardStyle}" Margin="5,0,5,0">
                                    <StackPanel>
                                        <TextBlock Text="📝" FontSize="24" Margin="0,0,0,5"/>
                                        <TextBlock Text="Total Bookings" 
                                                  FontSize="12" 
                                                  Foreground="#666666"/>
                                        <TextBlock Text="{Binding Analytics.TotalBookings}" 
                                                  FontSize="28" 
                                                  FontWeight="Bold" 
                                                  Foreground="#4CAF50" 
                                                  Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>

                                <!-- Total Revenue -->
                                <Border Grid.Column="2" Style="{StaticResource StatCardStyle}" Margin="10,0,0,0">
                                    <StackPanel>
                                        <TextBlock Text="💰" FontSize="24" Margin="0,0,0,5"/>
                                        <TextBlock Text="Total Revenue" 
                                                  FontSize="12" 
                                                  Foreground="#666666"/>
                                        <TextBlock Text="{Binding Analytics.TotalRevenueFormatted}" 
                                                  FontSize="20" 
                                                  FontWeight="Bold" 
                                                  Foreground="#E74C3C" 
                                                  Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>
                            </Grid>

                            <!-- Revenue Chart -->
                            <Border Style="{StaticResource CardStyle}" Margin="0">
                                <StackPanel>
                                    <TextBlock Text="Revenue Overview (Last 6 Months)" 
                                              FontSize="18" 
                                              FontWeight="SemiBold" 
                                              Margin="0,0,0,15"/>
                                    <lvc:CartesianChart x:Name="RevenueChart" 
                                                       Height="300" 
                                                       LegendLocation="Bottom">
                                        <lvc:CartesianChart.AxisX>
                                            <lvc:Axis Title="Month"/>
                                        </lvc:CartesianChart.AxisX>
                                        <lvc:CartesianChart.AxisY>
                                            <lvc:Axis Title="Revenue (Rp)"/>
                                        </lvc:CartesianChart.AxisY>
                                    </lvc:CartesianChart>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- Right Column: Category Distribution -->
                        <Border Grid.Column="1" Style="{StaticResource CardStyle}" Margin="10,0,0,0">
                            <StackPanel>
                                <TextBlock Text="Category Distribution" 
                                          FontSize="18" 
                                          FontWeight="SemiBold" 
                                          Margin="0,0,0,15"/>
                                <lvc:PieChart x:Name="CategoryChart"
                                             Height="450" 
                                             LegendLocation="Bottom"
                                             InnerRadius="50"/>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- Destinations List -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <!-- Header -->
                            <TextBlock Text="Your Destinations" 
                                      FontSize="20" 
                                      FontWeight="SemiBold"
                                      Margin="0,0,0,20"/>

                            <!-- Empty State -->
                            <StackPanel Visibility="{Binding HasDestinations, Converter={StaticResource InverseBoolToVisibilityConverter}}"
                                       HorizontalAlignment="Center" 
                                       Margin="40">
                                <TextBlock Text="📍" FontSize="64" HorizontalAlignment="Center" Opacity="0.3"/>
                                <TextBlock Text="{Binding EmptyMessage}" 
                                          FontSize="16" 
                                          Foreground="#999999" 
                                          Margin="0,10,0,0"
                                          HorizontalAlignment="Center"/>
                            </StackPanel>

                            <!-- Destinations List -->
                            <ItemsControl ItemsSource="{Binding Destinations}"
                                        Visibility="{Binding HasDestinations, Converter={StaticResource BoolToVisibilityConverter}}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="White"
                                               BorderBrush="#E0E0E0"
                                               BorderThickness="1"
                                               CornerRadius="8"
                                               Padding="15"
                                               Margin="0,0,0,15">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="120"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <!-- Image -->
                                                <Border Grid.Column="0" 
                                                       Width="100" 
                                                       Height="100" 
                                                       CornerRadius="8"
                                                       Background="#E0E0E0"
                                                       Margin="0,0,15,0">
                                                    <TextBlock Text="🏨" 
                                                              FontSize="40" 
                                                              HorizontalAlignment="Center" 
                                                              VerticalAlignment="Center"
                                                              Opacity="0.5"/>
                                                </Border>

                                                <!-- Info -->
                                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding Name}" 
                                                              FontSize="18" 
                                                              FontWeight="SemiBold" 
                                                              Foreground="#333333"/>
                                                    <TextBlock Text="{Binding Location}" 
                                                              FontSize="14" 
                                                              Foreground="#666666" 
                                                              Margin="0,3,0,0"/>

                                                    <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                                        <Border Background="#E8E8E8" 
                                                               Padding="8,4" 
                                                               CornerRadius="4" 
                                                               Margin="0,0,8,0">
                                                            <TextBlock Text="{Binding Category}" 
                                                                      FontSize="12" 
                                                                      Foreground="{StaticResource TextGray}"/>
                                                        </Border>
                                                        <Border Background="#E8E8E8" 
                                                               Padding="8,4" 
                                                               CornerRadius="4" 
                                                               Margin="0,0,8,0">
                                                            <TextBlock Text="{Binding PriceFormatted}" 
                                                                      FontSize="12" 
                                                                      Foreground="{StaticResource TextGray}"/>
                                                        </Border>
                                                    </StackPanel>
                                                </StackPanel>

                                                <!-- Stats -->
                                                <StackPanel Grid.Column="2" VerticalAlignment="Center" Margin="20,0,0,0">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>

                                                        <!-- Bookings -->
                                                        <StackPanel Grid.Column="0" Margin="0,0,20,0">
                                                            <TextBlock Text="Bookings" 
                                                                      FontSize="11" 
                                                                      Foreground="#999999"/>
                                                            <TextBlock Text="{Binding TotalBookings}" 
                                                                      FontSize="20" 
                                                                      FontWeight="Bold" 
                                                                      Foreground="#4CAF50"/>
                                                        </StackPanel>

                                                        <!-- Revenue -->
                                                        <StackPanel Grid.Column="1" Margin="0,0,20,0">
                                                            <TextBlock Text="Revenue" 
                                                                      FontSize="11" 
                                                                      Foreground="#999999"/>
                                                            <TextBlock Text="{Binding TotalRevenueFormatted}" 
                                                                      FontSize="16" 
                                                                      FontWeight="Bold" 
                                                                      Foreground="#E74C3C"/>
                                                        </StackPanel>
                                                    </Grid>

                                                    <!-- Additional Stats -->
                                                    <StackPanel Orientation="Horizontal" 
                                                               Margin="0,10,0,0" 
                                                               HorizontalAlignment="Right">
                                                        <TextBlock Text="{Binding TotalVisitors}" 
                                                                  FontSize="13" 
                                                                  Foreground="#666666"/>
                                                        <TextBlock Text=" visitors" 
                                                                  FontSize="13" 
                                                                  Foreground="#999999"/>
                                                        <TextBlock Text=" • " 
                                                                  FontSize="13" 
                                                                  Foreground="#999999" 
                                                                  Margin="5,0"/>
                                                        <TextBlock Text="{Binding TotalReviews}" 
                                                                  FontSize="13" 
                                                                  Foreground="#666666"/>
                                                        <TextBlock Text=" reviews" 
                                                                  FontSize="13" 
                                                                  Foreground="#999999"/>
                                                    </StackPanel>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>